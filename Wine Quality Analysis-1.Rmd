---
title: 
output:
  word_document: default
  html_document: default
---
<center> <h1> </h1> </center>
<center>  <h3>  </h2> </center>
<center> <h3>  </h2> </center>
---


```{r}

#Read the dataset and check the datatypes of the attributes
wine_data <- read.csv("winequality-white.csv", header = TRUE, sep = ";")
sapply(wine_data,class)
```


```{r}

# Check for missing values
sum(is.na(wine_data))
```
There are no missing values.



```{r}

#Find the correlation between attributes other than quality
#install.packages("corrplot")
library(corrplot)
correlation = cor(wine_data[-12])
correlation
corrplot(correlation)
```

```{r}
#Plot the histogram for wine quality
hist(wine_data$quality, xlab= "Quality", main = "Histogram of Wine Quality")
```

```{r}

#Assign Fail to wine quality <= 5 and Pass for wine quality > 5
wine_data$quality <- ifelse(wine_data$quality <= 5, "Fail", "Pass")
wine_data$quality <- ordered(wine_data$quality, c('Fail', 'Pass'))


```

```{r}

#Normalize the dataset
norm = function(x) {
  return ((x - min(x)) / (max(x) - min(x)))
  }
wine_data2 = as.data.frame(sapply(wine_data[-12],norm))
```

```{r}

#Add the quality column back into the normalized dataset and then remove it for training and testing
wine_data2$quality <- wine_data$quality
train_ind = sample(nrow(wine_data), 0.7 * nrow(wine_data))
train.set = wine_data2[train_ind,]
test.set = wine_data2[-train_ind,]
train.set_new = train.set[-12]
test.set_new = test.set[-12]
```

```{r}

# Predict the quality of wine. Used head() to get the first five outcomes in the dataset
glm_model <- glm(quality~.,train.set, family = "binomial")
head(predict(glm_model,type = "response"))
predicted <- predict(glm_model, test.set, type = "response")
```
```{r}

#Create the confusion Matrix
predicted <- predict(glm_model, test.set, type = "response")
predicted_class <- ifelse(predicted>=0.5, 1, 0)
ConfusionMatrix <- table(actual = test.set$quality, predicted = predicted_class)
ConfusionMatrix
```

```{r}

# Get the TN, FP, FN, and TP values
# calculate specificity, sensitivity, and accuracy using the TN, FP, FN, and TP
# values
TN = ConfusionMatrix[1,1]

FP = ConfusionMatrix[1,2]

FN = ConfusionMatrix[2,1]

TP = ConfusionMatrix[2,2]

sensitivity = TP/(TP+FN)
cat("Sensitivity:",sensitivity)

specificity = TN/(TN+FP)
cat(' Specificity:',specificity)

accuracy = (TP+TN)/(TP+FN+FP+TN)
cat(' Accuracy:',accuracy)

```

